<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>判断题模板</title>
    <link href="panduanstyle.css" type="text/css" rel="stylesheet"/>
</head>
<body>
    <!-- 左侧题号导航（每行3个） -->
    <div class="question-nav" id="questionNav">
        <div class="nav-title">题目导航（每行3个）</div>
        <div class="nav-list" id="navList"></div>
    </div>

    <!-- 中间答题容器 -->
    <div class="container">
        <h1>判断题闯关挑战（交互式完整版）</h1>
        
        <!-- 答题进度 -->
        <div class="question-progress" id="questionProgress">当前：第1题 / 共15题</div>
        
        <!-- 判断题列表 -->
        <div class="question-list" id="questionList">
            <!-- 题目1 -->
            <div class="question-card" data-question-id="1">
                <div class="question-title">1.在Word2010中，给段落添加项目符号，可以通过“插入”选项卡→“符号”→“其他符号”来实现。(  )</div>
                <img src="images/word_judge_question_1.png" alt="" class="question-img" style="width: 160px;">
                <div class="judge-options">
                    <div class="judge-item">
                        <input type="radio" name="q1" value="对" id="q1a">
                        <label for="q1a">对</label>
                    </div>
                    <div class="judge-item">
                        <input type="radio" name="q1" value="错" id="q1b">
                        <label for="q1b">错</label>
                    </div>
                </div>
                <div class="answer-info" style="display: none;" data-correct-answer="对">
                    解析：Word 2010、2013、2016等版本的默认保存格式为.docx，而Word 2003及以下版本的默认保存格式为.doc。
                </div>
                <div class="analysis-area" id="analysis1">
                    <div class="analysis-title">答题解析</div>
                    <div class="analysis-content" id="analysisContent1"></div>
                </div>
            </div>

            <!-- 题目2 -->
            <div class="question-card" data-question-id="2">
                <div class="question-title">2.在Word2010中，要完成内容的剪切、复制、粘贴等操作，除了可以使用快捷键外，还可以使用“开始”选项卡中对应的命令。</div>
                <div class="judge-options">
                    <div class="judge-item">
                        <input type="radio" name="q2" value="对" id="q2a">
                        <label for="q2a">对</label>
                    </div>
                    <div class="judge-item">
                        <input type="radio" name="q2" value="错" id="q2b">
                        <label for="q2b">错</label>
                    </div>
                </div>
                <div class="answer-info" style="display: none;" data-correct-answer="对">
                    在Word2010软件操作中，“开始”选项卡集成了常用的文本编辑命令，其中就包含剪切、复制、粘贴功能，同时用户也可使用如Ctrl+X（剪切）、Ctrl+C（复制）、Ctrl+V（粘贴）等快捷键完成相同操作，所以该说法正确。
                </div>
                <div class="analysis-area" id="analysis2">
                    <div class="analysis-title">答题解析</div>
                    <div class="analysis-content" id="analysisContent2"></div>
                </div>
            </div>

            <!-- 题目3 -->
            <div class="question-card" data-question-id="3">
                <div class="question-title">3.在Word2010中编辑文档时，要找回误删的文字或图片，可以打开回收站，选定要恢复的内容，执行“还原选定的项目”来恢复文字或图片。</div>
                <div class="judge-options">
                    <div class="judge-item">
                        <input type="radio" name="q3" value="对" id="q3a">
                        <label for="q3a">对</label>
                    </div>
                    <div class="judge-item">
                        <input type="radio" name="q3" value="错" id="q3b">
                        <label for="q3b">错</label>
                    </div>
                </div>
                <div class="answer-info" style="display:none;" data-correct-answer="错">
                    在Word2010编辑文档时，误删的文字或图片并不会进入计算机的回收站。通常可使用Word自身的撤销功能（快捷键Ctrl + Z）来找回误删内容 ，所以该说法错误。
                </div>
                <div class="analysis-area" id="analysis3">
                    <div class="analysis-title">答题解析</div>
                    <div class="analysis-content" id="analysisContent3"></div>
                </div>
            </div>

            <!-- 题目4 -->
            <div class="question-card" data-question-id="4">
                <div class="question-title">4.陈老师想将几位同学编写的介绍丽江景点的文档汇总成一个文档，最便捷的方法是使用word的文件合并功能。</div>
                <img src="images/word_judge_question_4.png" alt="" class="question-img" style="width:200px;">
                <div class="judge-options">
                    <div class="judge-item">
                        <input type="radio" name="q4" value="对" id="q4a">
                        <label for="q4a">对</label>
                    </div>
                    <div class="judge-item">
                        <input type="radio" name="q4" value="错" id="q4b">
                        <label for="q4b">错</label>
                    </div>
                </div>
                <div class="answer-info" style="display:none;" data-correct-answer="对">
                    在Word中，文件合并功能能够将多个文档内容整合到一个文档中，相比手动复制粘贴等方式，极大提高了汇总效率，是将多个文档汇总的便捷方法。
                </div>
                <div class="analysis-area" id="analysis4">
                    <div class="analysis-title">答题解析</div>
                    <div class="analysis-content" id="analysisContent4"></div>
                </div>
            </div>
            <!-- 题目5 -->
            <div class="question-card" data-question-id="5">
                <div class="question-title">5.在Word2010中，编辑文档时可以使用书签链接来打开引用的外部链接文件。</div>
                <div class="judge-options">
                    <div class="judge-item">
                        <input type="radio" name="q5" value="对" id="q5a">
                        <label for="q5a">对</label>
                    </div>
                    <div class="judge-item">
                        <input type="radio" name="q5" value="错" id="q5b">
                        <label for="q5b">错</label>
                    </div>
                </div>
                <div class="answer-info" style="display:none;" data-correct-answer="错">
                    在Word2010中，书签主要用于在文档内部创建定位标记，方便在文档内快速跳转，不能直接用于打开引用的外部链接文件。若要打开外部链接文件，通常使用超链接功能。所以该说法错误。
                </div>
                <div class="analysis-area" id="analysis5">
                    <div class="analysis-title">答题解析</div>
                    <div class="analysis-content" id="analysisContent5"></div>
                </div>
            </div>

            <div class="question-card" data-question-id="6">
                <div class="question-title">6.如图所示，在“页面设置”对话框中，若将纸张方向设置为“横向”，此时文档的上下页边距是5.08厘米，左右页边距是2.54厘米。(  )</div>
                <img src="images/word_judge_question_6.png" alt="" class="question-img" style="width:260px;">
                <div class="judge-options">
                    <div class="judge-item">
                        <input type="radio" name="q6" value="对" id="q6a">
                        <label for="q6a">对</label>
                    </div>
                    <div class="judge-item">
                        <input type="radio" name="q6" value="错" id="q6b">
                        <label for="q6b">错</label>
                    </div>
                </div>
                <div class="answer-info" style="display:none;" data-correct-answer="错">
                    已知原来上下页边距是2.54厘米，左右页边距是5.08厘米 ，当纸张方向设置为“横向”后，上下和左右页边距概念互换，但数值并不会自动改变，所以此时文档的上下页边距应是2.54厘米，左右页边距应是5.08厘米，而题目表述与之不符，故该说法错误。
                </div>
                <div class="analysis-area" id="analysis6">
                    <div class="analysis-title">答题解析</div>
                    <div class="analysis-content" id="analysisContent6"></div>
                </div>
            </div>









        </div>

        <!-- 底部按钮 -->
        <button class="btn next-btn-bottom" id="nextBtnBottom">进入下一题</button>
        <button class="btn submit-btn" id="submitAllBtn" style="display: none;">提交所有答案并查看统计结果</button>

        <!-- 结果统计区域 -->
        <div class="result-container" id="resultContainer">
            <div class="result-title">闯关完成！答题统计</div>
            <div class="result-info" id="totalCount">总答题数：0题</div>
            <div class="result-info" id="correctCount">答对题数：0题</div>
            <div class="result-info" id="accuracyRate">正确率：0%</div>
        </div>

        <!-- 右侧上下题按钮 -->
        <div class="btn-sidebar" id="btnSidebar">
            <button class="sidebar-btn prev-btn" id="prevBtn">↑</button>
            <button class="sidebar-btn next-btn" id="sidebarNextBtn">↓</button>
        </div>
    </div>

    <!-- 自定义提示框 -->
    <div class="custom-tip" id="customTip">
        <div class="tip-title" id="tipTitle"></div>
        <div class="tip-content" id="tipContent"></div>
        <button class="tip-confirm" id="tipConfirm">确定</button>
    </div>

    <script>
        // 全局变量
        let answerRecord = { total: 0, correct: 0 };
        let currentQuestionIndex = 0;
        let allQuestionCards = [];
        let allNavItems = [];
        const customTip = document.getElementById('customTip');
        const prevBtn = document.getElementById('prevBtn');
        const sidebarNextBtn = document.getElementById('sidebarNextBtn');
        const nextBtnBottom = document.getElementById('nextBtnBottom');

        // 页面加载完成初始化
        window.onload = function() {
            // 1. 初始化题目数据
            allQuestionCards = Array.from(document.querySelectorAll('.question-card'));
            answerRecord.total = allQuestionCards.length;
            document.getElementById('totalCount').innerText = `总答题数：${answerRecord.total}题`;

            // 2. 动态生成左侧题号导航（每行3个）
            generateQuestionNav();

            // 3. 显示第一题，更新状态
            showCurrentQuestion();

            // 4. 更新侧边按钮状态
            updateSidebarBtnStatus();

            // 5. 绑定判断题选项点击事件
            bindJudgeOptionEvents();

            // 6. 绑定提示框确定按钮
            document.getElementById('tipConfirm').addEventListener('click', () => {
                customTip.style.display = 'none';
            });

            // 7. 绑定底部下一题按钮
            nextBtnBottom.addEventListener('click', () => {
                goToNextQuestion();
                nextBtnBottom.style.display = 'none';
            });

            // 8. 绑定右侧上下题按钮
            prevBtn.addEventListener('click', goToPrevQuestion);
            sidebarNextBtn.addEventListener('click', () => {
                goToNextQuestion();
                nextBtnBottom.style.display = 'none';
            });

            // 9. 绑定提交按钮事件
            document.getElementById('submitAllBtn').addEventListener('click', submitResult);
        };

        // 生成左侧题号导航（每行3个）
        function generateQuestionNav() {
            const navList = document.getElementById('navList');
            navList.innerHTML = '';

            for (let i = 0; i < allQuestionCards.length; i++) {
                const navItem = document.createElement('a');
                navItem.className = 'nav-item';
                navItem.dataset.index = i;
                navItem.innerText = i + 1;

                // 绑定题号跳转事件
                navItem.addEventListener('click', () => {
                    goToSpecificQuestion(parseInt(navItem.dataset.index));
                });

                navList.appendChild(navItem);
                allNavItems.push(navItem);
            }
        }

        // 绑定判断题选项事件
        function bindJudgeOptionEvents() {
            const allRadioInputs = document.querySelectorAll('input[type="radio"]');
            allRadioInputs.forEach(input => {
                input.addEventListener('change', function() {
                    const currentQuestion = this.closest('.question-card');
                    const questionId = currentQuestion.getAttribute('data-question-id');
                    const answerInfo = currentQuestion.querySelector('.answer-info');
                    const correctAnswer = answerInfo.getAttribute('data-correct-answer');
                    const userAnswer = this.value;
                    const analysis = answerInfo.innerText;

                    // 禁用当前题所有选项
                    disableCurrentQuestionOptions(currentQuestion);

                    // 高亮对错选项
                    highlightJudgeOption(currentQuestion, correctAnswer, userAnswer);

                    // 显示解析
                    showAnalysis(questionId, analysis);

                    // 更新答题结果和题号样式
                    updateAnswerResult(currentQuestion, userAnswer === correctAnswer, questionId - 1);

                    // 显示提示框
                    showTip(userAnswer === correctAnswer, correctAnswer);

                    // 显示底部按钮（最后一题显示提交）
                    if (currentQuestionIndex < allQuestionCards.length - 1) {
                        nextBtnBottom.style.display = 'block';
                    } else {
                        document.getElementById('submitAllBtn').style.display = 'block';
                    }
                });
            });
        }

        // 高亮判断题选项
        function highlightJudgeOption(questionCard, correctAnswer, userAnswer) {
            const judgeItems = questionCard.querySelectorAll('.judge-item');
            judgeItems.forEach(item => {
                const input = item.querySelector('input');
                if (input.value === correctAnswer) {
                    item.classList.add('correct');
                } else if (input.value === userAnswer && userAnswer !== correctAnswer) {
                    item.classList.add('incorrect');
                }
            });
        }

        // 显示解析
        function showAnalysis(questionId, analysis) {
            const analysisContent = document.getElementById(`analysisContent${questionId}`);
            const analysisArea = document.getElementById(`analysis${questionId}`);
            analysisContent.innerText = analysis;
            analysisArea.style.display = 'block';
        }

        // 更新答题结果
        function updateAnswerResult(questionCard, isCorrect, index) {
            questionCard.setAttribute('data-is-correct', isCorrect);
            if (isCorrect) {
                allNavItems[index].classList.add('correct');
                allNavItems[index].classList.remove('incorrect');
            } else {
                allNavItems[index].classList.add('incorrect');
                allNavItems[index].classList.remove('correct');
            }
        }

        // 显示提示框
        function showTip(isCorrect, correctAnswer) {
            const tipTitle = document.getElementById('tipTitle');
            const tipContent = document.getElementById('tipContent');

            customTip.className = 'custom-tip';
            if (isCorrect) {
                customTip.classList.add('correct-tip');
                tipTitle.innerText = '回答正确！';
                tipContent.innerText = '恭喜你，掌握了该知识点～';
            } else {
                customTip.classList.add('error-tip');
                tipTitle.innerText = '回答错误';
                tipContent.innerText = `正确答案是：${correctAnswer}，请仔细查看下方解析哦～`;
            }
            customTip.style.display = 'block';
        }

        // 跳转到指定题目
        function goToSpecificQuestion(targetIndex) {
            if (targetIndex < 0 || targetIndex >= allQuestionCards.length) return;

            // 隐藏当前题
            allQuestionCards[currentQuestionIndex].classList.remove('active');
            allNavItems[currentQuestionIndex].classList.remove('active');

            // 更新当前索引
            currentQuestionIndex = targetIndex;

            // 显示目标题
            showCurrentQuestion();

            // 更新侧边按钮状态
            updateSidebarBtnStatus();

            // 隐藏底部下一题按钮
            nextBtnBottom.style.display = 'none';
        }

        // 跳转到上一题
        function goToPrevQuestion() {
            goToSpecificQuestion(currentQuestionIndex - 1);
        }

        // 跳转到下一题
        function goToNextQuestion() {
            goToSpecificQuestion(currentQuestionIndex + 1);
        }

        // 显示当前题目
        function showCurrentQuestion() {
            allQuestionCards[currentQuestionIndex].classList.add('active');
            allNavItems[currentQuestionIndex].classList.add('active');

            // 更新进度提示
            document.getElementById('questionProgress').innerText = 
                `当前：第${currentQuestionIndex + 1}题 / 共${answerRecord.total}题`;
        }

        // 更新侧边按钮状态
        function updateSidebarBtnStatus() {
            // 上一题按钮
            if (currentQuestionIndex === 0) {
                prevBtn.classList.remove('enabled');
            } else {
                prevBtn.classList.add('enabled');
            }

            // 下一题按钮
            if (currentQuestionIndex === allQuestionCards.length - 1) {
                sidebarNextBtn.classList.remove('enabled');
            } else {
                sidebarNextBtn.classList.add('enabled');
            }
        }

        // 禁用当前题选项
        function disableCurrentQuestionOptions(questionCard) {
            const radioInputs = questionCard.querySelectorAll('input[type="radio"]');
            radioInputs.forEach(radio => radio.disabled = true);
        }

        // 提交结果并统计
        function submitResult() {
            // 统计答对题数
            answerRecord.correct = 0;
            allQuestionCards.forEach(card => {
                if (card.getAttribute('data-is-correct') === 'true') {
                    answerRecord.correct++;
                }
            });

            // 计算正确率
            const accuracy = answerRecord.total > 0 
                ? ((answerRecord.correct / answerRecord.total) * 100).toFixed(2) 
                : '0.00';

            // 更新统计结果
            document.getElementById('correctCount').innerText = `答对题数：${answerRecord.correct}题`;
            document.getElementById('accuracyRate').innerText = `正确率：${accuracy}%`;
            document.getElementById('resultContainer').style.display = 'block';

            // 显示最终提示框
            showTip(true, '');
            document.getElementById('tipTitle').innerText = '闯关完成！';
            document.getElementById('tipContent').innerText = 
                `总题数：${answerRecord.total}题\n答对题数：${answerRecord.correct}题\n正确率：${accuracy}%`;
        }
    </script>
</body>
</html>